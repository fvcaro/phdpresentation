\def\layersep{1.5cm}

\def\checkmark{\tikz\fill[scale=0.8, color=green_jon](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;} 
\definecolor{green_jon}{rgb}{0.0, 0.5, 0.0}

\begin{frame}{Geophysics Synthetic Example: Input Measurements}
\vspace{-0.35 cm}
\begin{figure}[H]
	\centering
	\begin{tikzpicture}[scale=1.0]
	\node (layers) at (0.0,0.0)[scale=0.7]{
		\input{Diapos/DL_For_Inv/Figures/Syn_example/Fig_tool1.tex}
	};       
	\end{tikzpicture}
\end{figure}
\vspace{-0.7 cm}

	\begin{itemize}
		\item Co-axial attenuation and phase difference
	\end{itemize}
	
	\vspace{0.4 cm}

\begin{figure}[H]
	\centering
	\begin{tikzpicture}[scale=1.0]
	\node (layers) at (0.0,0.0)[scale=0.7]{
		\input{Diapos/DL_For_Inv/Figures/Syn_example/Fig_tool2.tex}
	};       
	\end{tikzpicture}
\end{figure}
\vspace{-0.7 cm}
	\begin{itemize}
		\item Co-axial attenuation and phase difference
		\item Geosignal
	\end{itemize}
\end{frame}


\begin{frame}{Geophysics Synthetic Example: Output Earth Parametrization}
\begin{columns}
    \begin{column}{0.35\textwidth}
    \begin{figure}[!h]
	\centering
	\input{Diapos/DL_For_Inv/Figures/Syn_example/1D_1_position.tex}
	\label{fig:param}
	\end{figure}
    \end{column}
    \begin{column}{0.5\textwidth}
        {\footnotesize $\rho_u \in [1,10^2] \Omega \cdot m$: Upper layer resistivity}\\
        \vspace{0.3cm}
        {\footnotesize $\rho_h \in [1,10^2] \Omega \cdot m$: Central layer resistivity}\\
        \vspace{0.3cm}
        {\footnotesize $\rho_l \in [1,10^2] \Omega \cdot m$: Lower layer resistivity}\\
        \vspace{0.3cm}
        {\footnotesize $d_u \in [10^{-2},10] m$: Vertical distance to upper layer}\\
        \vspace{0.3cm}
        {\footnotesize $d_l \in [10^{-2},10] m$: Vertical distance to lower layer}
    \end{column}
\end{columns}
\end{frame}


%\begin{frame}[t]{Deep Neural Networks (Deep Learning) for Inverse Problems}\linespread{1.05}
%\vspace{-.2 cm}
%\begin{center}
%	Approximate: ${\cal I} \approx {\cal I}_{\phi} :=  N \circ A_k \circ N \circ A_{k-1}  \circ \cdots \circ N \circ A_1 $\\
%\end{center}
%\only<1>{
%	\vspace{0.2 cm}
%	\centerline{$N$ -- Non-linear activation function  \hspace{0.3 cm};\hspace{0.3 cm} $A_k$ -- Affine transformation}
%	\vspace{0.6cm}
%\begin{figure}
%	\vspace*{-0.25in}
%	\input{Diapos/DL_For_Inv/Figures/Syn_example/fully_connected_network.tex}
%\end{figure}}
%\only<2>{
%	\vspace{0.4cm}
%	
%	$A_k$ -- Affine transformation: \hspace{0.1cm} $A_k \cdot x+b_k$
%	\vspace{0.4cm}
%	
%	$N$ -- Non-linear activation function:
%
%	\begin{figure}
%	\centering
%		\begin{subfigure}{.5\textwidth}
%		\centering
%		\input{Diapos/DL_For_Inv/Figures/Syn_example/tanh.tex}
%		%	\caption{Tanh}
%		\label{fig:tanh}
%		\end{subfigure}%
%		\begin{subfigure}{.5\textwidth}
%		\centering
%		\input{Diapos/DL_For_Inv/Figures/Syn_example/ReLU.tex}
%		%	\caption{Tanh}
%		\label{fig:tanh}
%		\end{subfigure}
%%	\caption{A figure with two subfigures}
%	\label{fig:test}
%	\end{figure}
%	}
%\end{frame}


\begin{frame}{Synthetic Example}
\begin{center}
{\large Formation of model problem}
\end{center}
\begin{figure}
		\centering
		\input{Diapos/DL_For_Inv/Figures/Syn_example/Numerical_results/real.tex}
	%\caption{Formation of model problem}
	\label{fig:formation_model_1_original}
\end{figure}
\end{frame}


\begin{frame}{Encoder-Decoder Loss}
\begin{center}
{\large Predicted formation}
\end{center}
\begin{figure}
		\centering
		\input{Diapos/DL_For_Inv/Figures/Syn_example/Numerical_results/Enco-Deco/Predicted_F_FI.tex}
	%\caption{Formation of model problem}
	\label{fig:formation_model_1_original}
\end{figure}
\end{frame}


\begin{frame}{Cross-plot 1}
\centering
\setlength{\fboxrule}{0.5mm}
\setlength{\fboxsep}{1mm}
\color{red}
\fbox{\parbox{3cm}{{\begin{align}
\textcolor{black}{\mathcal{F} \circ \mathcal{I} \hspace{0.25cm} vs \hspace{0.25cm} \mathcal{F}_{\theta^\ast} \circ \mathcal{I}}
\notag
\end{align}}}}
\color{black}
To control: $\|{\cal F}_{\theta}({\bf P})-{\bf M} \|$ \hspace{1cm}  \visible<2>{\checkmark} \\
$\qquad$ \\
\hspace{0.8cm} Attenuation Geosignal $\qquad \qquad \qquad$ Phase difference Geosignal
\begin{figure}[!h]
\centering
	{\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_1/Atten-Geosignal_axis.pdf}%}
		\hspace{2cm}
	\includegraphics[trim=0cm 0cm 0.3cm 0.25cm ,scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_1/Phase-Geosignal_axis.pdf}}	
\end{figure}
\end{frame}
%==========================================================
\begin{frame}{Cross-plot 2}
\centering
\setlength{\fboxrule}{0.5mm}
\setlength{\fboxsep}{1mm}
\color{red}
\fbox{\parbox{3cm}{{\begin{align}
\textcolor{black}
{\mathcal{F} \circ \mathcal{I} \hspace{0.25cm} vs \hspace{0.25cm} \mathcal{F}_{\theta^\ast} \circ \mathcal{I}_{\phi^\ast}}
\notag
\end{align}}}}
\color{black}
To control: $\|(\mathcal{F}_{\theta} \circ \mathcal{I}_{\phi})(\mathbf{M})-\mathbf{M}\|$ \hspace{1cm} \visible<2>{\checkmark} \\
$\qquad$ \\
\hspace{0.8cm} Attenuation Geosignal $\qquad \qquad \qquad$ Phase difference Geosignal
\begin{figure}[!h]
\centering
	{%
		\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_2/Atten-Geosignal_FI_axis.pdf}
		\hspace{2cm}
		\includegraphics[trim=0cm 0cm 0.3cm 0.25cm, scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_2/Phase-Geosignal_FI_axis.pdf}}
\end{figure}	
\end{frame}
%==========================================================
\begin{frame}{Cross-plot 3}
\centering
\setlength{\fboxrule}{0.5mm}
\setlength{\fboxsep}{1mm}
\color{red}
\fbox{\parbox{3cm}{{\begin{align}
\textcolor{black}
{\mathcal{F} \circ \mathcal{I} \hspace{0.25cm} vs\hspace{0.25cm} \mathcal{F} \circ \mathcal{I}_{\phi^\ast}}
\notag
\end{align}}}}
\color{black}
To control: Solution of inverse problem \hspace{1cm} \visible<2>{\textcolor{red}{{\LARGE \textbf{X}}}} \\
$\qquad$ \\
\hspace{0.8cm} Attenuation Azimuthal $\qquad \qquad \enskip \enskip$ Phase difference Azimuthal
\begin{figure}[!h]
\centering
	{%
		\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_3_NOreg/Atten-Azim_axis.pdf}
		\hspace{2cm}
		\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_3_NOreg/Phase-Azim_axis.pdf}}
\end{figure}	
\end{frame}


\begin{frame}{Regularization}
%\vspace{-0.5cm}
\begin{equation}
\begin{aligned}
	(\mathcal{F}_{\theta^\ast}, \mathcal{I}_{\phi^\ast}):=\arg \min_{\phi \in \Phi, \theta \in \Theta} \{ & \|(\mathcal{F}_{\theta} \circ \textcolor{blue}{\mathcal{I}_{\phi}})(\mathbf{M})-\mathbf{M}\| + \textcolor{green_jon}{\|{\cal F}_{\theta}({\bf P})-{\bf M}\|} \}
\end{aligned}
\notag
\end{equation}

\begin{figure}[!h]
	\centering
	\input{Diapos/DL_For_Inv/Figures/regularization.tex}
	\label{fig:regu}
\end{figure}

\center
\textcolor{green_jon}{x}=training samples

${\cal F}_\theta(\textcolor{green_jon}{x}) \approx {\cal F}(\textcolor{green_jon}{x})$

${\cal F}_\theta(\textcolor{blue}{O}) \neq {\cal F}(\textcolor{blue}{O})$
%\vspace{0.5cm}
\end{frame}


\begin{frame}{Regularization}
\begin{equation}
\begin{aligned}
	(\mathcal{F}_{\theta^\ast}, \mathcal{I}_{\phi^\ast}):=\arg \min_{\phi \in \Phi, \theta \in \Theta} \{ & \|(\mathcal{F}_{\theta} \circ \mathcal{I}_{\phi})(\mathbf{M})-\mathbf{M}\| +\|{\cal F}_{\theta}({\bf P})-{\bf M}\|\\
	&  + \textcolor{red}{\|{\cal I}_{\phi}({\bf M})-{\bf P}\| } \}
\end{aligned}
\notag
\end{equation} \\
$\qquad$ \\
\hspace{2.5cm} Attenuation Azimuthal $\qquad \qquad \enskip \enskip$ Phase difference Azimuthal
\begin{figure}[!h]
\centering
	{%
		\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_3_reg/Atten-Azim-2_axis.pdf}
		\hspace{2cm}
		\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_3_reg/Phase-Azim-2_axis.pdf}}	
\end{figure}	
\end{frame}


\begin{frame}{Cross-plot 4}
\centering
\setlength{\fboxrule}{0.5mm}
\setlength{\fboxsep}{1mm}
\color{red}
\fbox{\parbox{3cm}{{\begin{align}
\textcolor{black}
{\mathcal{I} \hspace{0.25cm} vs \hspace{0.25cm} \mathcal{I}_{\phi^\ast}}
\notag
\end{align}}}}
\color{black}
To control: Inversion variables \\
$\qquad$ \\
\hspace{0.5cm} $d_u$ $\qquad \qquad \qquad \qquad \qquad$ $\rho_h$ $\qquad \qquad \qquad \qquad \qquad$ $\rho_u$
\begin{figure}[!h]
\centering
	{%
		\includegraphics[scale=0.85]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_4/d_u/3_d_u_axis.pdf}
		\hspace{0.1cm}
		\includegraphics[scale=0.85]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_4/rho_h/15_rho_h_axis.pdf}
		\hspace{0.1cm}
		\includegraphics[scale=0.85]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/C_P_4/rho_u/9_rho_u_axis.pdf}
		}	
\end{figure}	
\end{frame}


\begin{frame}{Encoder-Decoder Loss}
Without Regularization
\begin{figure}[!h]
				\centering
	\input{Diapos/DL_For_Inv/Figures/Syn_example/Numerical_results/Enco-Deco/Predicted_F_FI_2.tex}%
	%\caption{Predicted formation using the Encoder-Decoder loss function with regularization}
\end{figure}
\vspace{-0.5cm}
With Regularization
\begin{figure}[!h]
	\centering
	\input{Diapos/DL_For_Inv/Figures/Syn_example/Numerical_results/Enco-Deco_REG/Predicted_F_FI_reg.tex}%
	%\caption{Deep coaxial measurement}
\end{figure}
\end{frame}


\begin{frame}{Encoder-Decoder Loss}
Real formation
\begin{figure}[!h]
				\centering
	\input{Diapos/DL_For_Inv/Figures/Syn_example/Numerical_results/real_2.tex}%
	%\caption{Predicted formation using the Encoder-Decoder loss function with regularization}
\end{figure}
\vspace{-0.5cm}
With Regularization
\begin{figure}[!h]
	\centering
	\input{Diapos/DL_For_Inv/Figures/Syn_example/Numerical_results/Enco-Deco_REG/Predicted_F_FI_reg.tex}%
	%\caption{Deep coaxial measurement}
\end{figure}
\end{frame}


\begin{frame}{Two-Step Loss}
Real formation
\begin{figure}[!h]
				\centering
	\input{Diapos/DL_For_Inv/Figures/Syn_example/Numerical_results/real_2.tex}%
	%\caption{Predicted formation using the Encoder-Decoder loss function with regularization}
\end{figure}
\vspace{-0.5cm}
Two-Step Loss
\begin{figure}[!h]
	\centering
	\input{Diapos/DL_For_Inv/Figures/Syn_example/Numerical_results/Two_Step/Predicted_F_FI_two_step.tex}%
	%\caption{Deep coaxial measurement}
\end{figure}
\end{frame}


\begin{frame}{Cross-plot 1}
\centering
\setlength{\fboxrule}{0.5mm}
\setlength{\fboxsep}{1mm}
\color{red}
\fbox{\parbox{3cm}{{\begin{align}
\textcolor{black}{\mathcal{F} \circ \mathcal{I} \hspace{0.25cm} vs \hspace{0.25cm} \mathcal{F}_{\theta^\ast} \circ \mathcal{I}}
\notag
\end{align}}}}
\color{black}
$\qquad$ \\
\hspace{0.8cm} Attenuation Geosignal $\qquad \qquad \qquad$ Phase difference Geosignal
\begin{figure}[!h]
\centering
	{\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_1/atten_geo.pdf}%
		\hspace{2cm}
	\includegraphics[trim=0cm 0cm 0.3cm 0.25cm ,scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_1/phase_geo.pdf}}	
\end{figure}
\end{frame}
%==========================================================
\begin{frame}{Cross-plot 2}
\centering
\setlength{\fboxrule}{0.5mm}
\setlength{\fboxsep}{1mm}
\color{red}
\fbox{\parbox{3cm}{{\begin{align}
\textcolor{black}
{\mathcal{F} \circ \mathcal{I} \hspace{0.25cm} vs \hspace{0.25cm} \mathcal{F}_{\theta^\ast} \circ \mathcal{I}_{\phi^\ast}}
\notag
\end{align}}}}
\color{black}
$\qquad$ \\
\hspace{0.8cm} Attenuation Geosignal $\qquad \qquad \qquad$ Phase difference Geosignal
\begin{figure}[!h]
\centering
	{%
		\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_2/atten_geo.pdf}
		\hspace{2cm}
		\includegraphics[trim=0cm 0cm 0.3cm 0.25cm, scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_2/phase_geo.pdf}}
\end{figure}	
\end{frame}
%==========================================================
\begin{frame}{Cross-plot 3}
\centering
\setlength{\fboxrule}{0.5mm}
\setlength{\fboxsep}{1mm}
\color{red}
\fbox{\parbox{3cm}{{\begin{align}
\textcolor{black}
{\mathcal{F} \circ \mathcal{I} \hspace{0.25cm} vs\hspace{0.25cm} \mathcal{F} \circ \mathcal{I}_{\phi^\ast}}
\notag
\end{align}}}}
\color{black}
$\qquad$ \\
\hspace{0.8cm} Attenuation Geosignal $\qquad \qquad \enskip \enskip$ Phase difference Geosignal
\begin{figure}[!h]
\centering
	{%
		\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_3/atten_geo.pdf}
		\hspace{2cm}
		\includegraphics[scale=0.9]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_3/phase_geo.pdf}}
\end{figure}	
\end{frame}
%==========================================================
\begin{frame}{Cross-plot 4}
\centering
\setlength{\fboxrule}{0.5mm}
\setlength{\fboxsep}{1mm}
\color{red}
\fbox{\parbox{3cm}{{\begin{align}
\textcolor{black}
{\mathcal{I} \hspace{0.25cm} vs \hspace{0.25cm} \mathcal{I}_{\phi^\ast}}
\notag
\end{align}}}}
\color{black}

$\qquad$ \\
\hspace{0.5cm} $d_u$ $\qquad \qquad \qquad \qquad \qquad$ $\rho_h$ $\qquad \qquad \qquad \qquad \qquad$ $\rho_u$
\begin{figure}[!h]
\centering
	{%
		\includegraphics[scale=0.8]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_4/d_u.pdf}
		\hspace{0.1cm}
		\includegraphics[scale=0.8]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_4/rho_h.pdf}
		\hspace{0.1cm}
		\includegraphics[scale=0.8]{Diapos/DL_For_Inv/Figures/Syn_example/Cross_plots/Two_Step_loss/C_P_4/rho_u.pdf}
		}	
\end{figure}	
\end{frame}


\begin{frame}{Deep Learning for Inverse Borehole Problems}
\begin{itemize}
\item Deep Learning (DL) is an adequate option to invert borehole resistivity measurements in real time.
\vspace{0.5cm}
\item Traditional loss functions are not effective.
\vspace{0.5cm}
\item Both Encoder-Decoder and Two-Step are adequate alternatives.
\vspace{0.5cm}
\item Encoder-Decoder demands a regularization term.
\end{itemize}
\end{frame}