%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Model problem 2 - High gradients}
\vspace{0.5cm}
\begin{tikzpicture}
%Problem

\draw[very thin,rounded corners=2pt, fill=orange!30!white ] (-1,0.4) rectangle (5.,3);

\node [anchor = west] at (-0.5,1.7){
$
\def\arraystretch{1.1}
\left\{ \! \! \!
\begin{array}{rll}
-\triangle u & \!\!= f &  x \in (0,10) 
\\
u & \!\!= 0 &  x =0 
\\
(\nabla u) \cdot \bf{n}  &\!\! =g &  x=10
\end{array}
\right.
$
};

%\draw[very thin,rounded corners=4pt, fill=gray!30!white ] (-1.8,2.7) rectangle (0.6,3.3);
%\node [anchor = west] at (-1.8,3){Test problem};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%small squares
\draw[very thin,rounded corners=2pt, fill=orange!30!white ] (-1.5,0) rectangle (5,-0.6);
\node [anchor =  west] at (-1.3,-0.3){
$u_{exact} = atan(2x - 10) + atan (10) $
};
%%%%%%%
%\draw[very thin,rounded corners=2pt, fill=gray!30!white ] (-1.5,-1) rectangle (2,-1.6);
%\node [anchor = west] at (-1.5,-1.3){
%$\alpha =2.0  \quad \beta=5.0$};

\node [anchor = west] at (-1.5,-2.7){
$\mathcal{T}_{r\text{-adap.}}$};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%Graph
\node [anchor = north east]at (12.5,2.9){
\begin{tikzpicture}
\begin{axis}[scale only axis, xlabel = $x$, ylabel = $u$, 
ytick pos=left,
xtick pos=left,
y label style={at={(-0.1,0.5)}}, 
height=6cm, width=5.5cm, 
xmin=0, ymin=0, 
xmax=10, ymax=3.2,
legend columns = 1,
legend style= {at={(0.5,0.95)},draw=none,fill=none,nodes={scale=1, transform shape}}, 
legend cell align={left}
]
%
%%exact solution
\addplot [black, line width=0.7pt,domain=0:10] table[x=x ,y=u_exact]{frames/Javi/data/piecewise_1D/atan/exact.csv};
\addlegendentry{$u_{exact}$};

%%%%%%%%%%%r-adaptive
\addplot[only marks, color = red, mark = *, mark options={solid},forget plot] 
coordinates{(2.5,9.768009205947777995e-02)(5,1.471106131310532472e+00)(7.5, 2.844542268351094805e+00)};

%r-adaptativity
\addplot[line width=0.6pt,color=red, densely dotted,mark=o, mark options={solid}] table[x=x ,y=u_pred]{frames/Javi/data/piecewise_1D/atan/r_adaptivity_pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_17_epoch_10000_partition.csv};
\addlegendentry{$u_{p}$ };
\end{axis}
\end{tikzpicture}
};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%Mesh
\node [anchor = west]at (-1.5,-3.5){
\begin{tikzpicture}
\begin{axis}[scale only axis,% xlabel = $x$, %ylabel = $u$, 
%ytick pos=left,
%xtick pos=left,
%y label style={at={(-0.1,0.5)}}, 
height=1cm, width=7cm,
axis y line=none, 
xmin=0, xmax = 10, 
legend cell align={left},
axis x line = center,
    axis y line = center,
    axis line style={-},
%    every axis/.style={pin distance=1ex},
%    trim axis left
]

\addplot[only marks,color=red,mark=|,thick, mark options={solid}] table[x=x ,y=malla]{frames/Javi/data/piecewise_1D/atan/r_adaptivity_pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_17_epoch_10000_partition.csv};


\end{axis}
\end{tikzpicture}
};



\end{tikzpicture}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{frame}{Model problem 2 - High gradients}
%\vspace{0.5cm}
%\begin{tikzpicture}
%%Problem
%
%\draw[very thin,rounded corners=2pt, fill=orange!30!white ] (-2,0.4) rectangle (5.6,3);
%
%\node [anchor = west] at (-2.1,1.7){
%$
%\def\arraystretch{1.1}
%\left\{ \! \! \!
%\begin{array}{rll}
%-\triangle u & \!\!= \dfrac{2 \alpha^3 (\beta-x)}{ (\alpha^2 (x-\beta)^2 +1)^2} &  x \in (0,10) 
%\\
%u & \!\!= 0 &  x =0 
%\\
%(\nabla u) \cdot \bf{n}  &\!\! =\dfrac{\alpha}{\alpha^2(x-\beta)^2 + 1} &  x=10
%\end{array}
%\right.
%$
%};
%
%%\draw[very thin,rounded corners=4pt, fill=gray!30!white ] (-1.8,2.7) rectangle (0.6,3.3);
%%\node [anchor = west] at (-1.8,3){Test problem};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%small squares
%\draw[very thin,rounded corners=2pt, fill=orange!30!white ] (-1.5,0) rectangle (5,-0.6);
%\node [anchor =  west] at (-1.5,-0.3){
%$u_{exact} = atan(\alpha ( x - \beta)) + atan (\alpha \beta) $
%};
%%%%%%%%
%\draw[very thin,rounded corners=2pt, fill=gray!30!white ] (-1.5,-1) rectangle (2,-1.6);
%\node [anchor = west] at (-1.5,-1.3){
%$\alpha =2.0  \quad \beta=5.0$};
%
%\node [anchor = west] at (-1.5,-2.7){
%$\mathcal{T}$};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%Graph
%\node [anchor = north east]at (12.5,2.9){
%\begin{tikzpicture}
%\begin{axis}[scale only axis, xlabel = $x$, ylabel = $u$, 
%ytick pos=left,
%xtick pos=left,
%y label style={at={(-0.1,0.5)}}, 
%height=6cm, width=5.5cm, 
%xmin=0, ymin=0, 
%xmax=10, ymax=3.2,
%legend columns = 1,
%legend style= {at={(0.5,0.95)},draw=none,fill=none,nodes={scale=1, transform shape}}, 
%legend cell align={left}
%]
%%
%%%exact solution
%\addplot [black, line width=0.7pt,domain=0:10] table[x=x ,y=u_exact]{frames/Javi/data/piecewise_1D/atan/exact.csv};
%\addlegendentry{$u_{exact}$};
%%%%%%%%%%%%h-adaptive
%%\addplot[line width=0.6pt,color=myGreen, densely dotted,] table[x=x ,y=u_pred]{frames/Javi/data/adaptative/u_atan.csv};
%%\addlegendentry{$u_{h\text{-adap.}}$};
%
%
%%%%%%%%%%%%r-adaptive
%\addplot[only marks, color = red, mark = *, mark options={solid},forget plot] 
%coordinates{(2.5,9.768009205947777995e-02)(5,1.471106131310532472e+00)(7.5, 2.844542268351094805e+00)};
%
%%r-adaptativity
%\addplot[line width=0.6pt,color=red, densely dotted,mark=o, mark options={solid}] table[x=x ,y=u_pred]{frames/Javi/data/piecewise_1D/atan/r_adaptivity_pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_17_epoch_10000_partition.csv};
%\addlegendentry{$u_{p}$ };
%
%%%piecewise
%%\addplot[line width=0.5pt,color=blue, dashed, mark=triangle, mark options={solid}] table[x=x ,y=u_pred]{frames/Javi/data/piecewise_1D/atan/pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_21_epoch_10000_partition.csv};
%%\addlegendentry{$u_{p=1}$ };
%
%
%%mesh
%%\addplot[only marks,color=red,mark=|, mark options={solid}] table[x=x ,y=malla]{data/piecewise_1D/atan/r_adaptivity_pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_17_epoch_10000_partition.csv};
%\end{axis}
%\end{tikzpicture}
%};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%Mesh
%\node [anchor = west]at (-1.5,-3.5){
%\begin{tikzpicture}
%\begin{axis}[scale only axis,% xlabel = $x$, %ylabel = $u$, 
%%ytick pos=left,
%%xtick pos=left,
%%y label style={at={(-0.1,0.5)}}, 
%height=1cm, width=7cm,
%axis y line=none, 
%xmin=0, xmax = 10, 
%legend cell align={left},
%axis x line = center,
%    axis y line = center,
%    axis line style={-},
%%    every axis/.style={pin distance=1ex},
%%    trim axis left
%]
%
%\addplot[only marks,color=red,mark=|,thick, mark options={solid}] table[x=x ,y=malla]{frames/Javi/data/piecewise_1D/atan/r_adaptivity_pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_17_epoch_10000_partition.csv};
%
%
%\end{axis}
%\end{tikzpicture}
%};
%
%
%
%\end{tikzpicture}
%
%\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{frame}{Numerical results}
%\vspace{0.2cm}
%\begin{tikzpicture}
%%Problem
%
%\draw[very thin,rounded corners=2pt, fill=orange!30!white ] (-2,0.4) rectangle (5.6,3);
%
%\node [anchor = west] at (-2.1,1.7){
%$
%\def\arraystretch{1.1}
%\left\{ \! \! \!
%\begin{array}{rll}
%-\triangle u & \!\!=  \dfrac{-2 \alpha^3 (\beta-x)}{ (\alpha^2 (x-\beta)^2 +1)^2} &  x \in (0,10) 
%\\
%u & \!\!= 0 &  x =0 
%\\
%(\nabla u) \cdot \bf{n}  &\!\! =\dfrac{\alpha}{\alpha^2(x-\beta)^2 + 1} &  x=10
%\end{array}
%\right.
%$
%};
%
%%\draw[very thin,rounded corners=4pt, fill=gray!30!white ] (-1.8,2.7) rectangle (0.6,3.3);
%%\node [anchor = west] at (-1.8,3){Test problem};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%right squares
%\draw[very thin,rounded corners=2pt, fill=orange!30!white ] (6,2.4) rectangle (12,3);
%\node [anchor = west] at (6.2,2.7){
%$\! \! \! \! u = atan(\alpha ( x - \beta)) + atan (\alpha \beta) $
%};
%%%%%%%%
%\draw[very thin,rounded corners=2pt, fill=gray!30!white ] (6,1.6) rectangle (9.5,2.2);
%\node [anchor = west] at (6.2,1.9){
%$\alpha =2.0  \quad \beta=5.0$};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%Graph
%\node at (1.2,-2.2){
%\begin{tikzpicture}
%\begin{axis}[scale only axis, xlabel = $x$, ylabel = $u$, 
%ytick pos=left,
%xtick pos=left,
%y label style={at={(-0.1,0.5)}}, 
%height=3.5cm, width=5.5cm, 
%xmin=0, ymin=0, 
%xmax=10, ymax=3.2,
%legend columns = 1,
%legend style= {at={(0.5,0.95)},draw=none,fill=none,nodes={scale=1, transform shape}}, 
%legend cell align={left}
%]
%%
%%%exact solution
%\addplot [black, line width=0.7pt,domain=0:10] table[x=x ,y=u_exact]{data/piecewise_1D/atan/exact.csv};
%\addlegendentry{$u$ };
%%%%%%%%%%%%h-adaptive
%\addplot[line width=0.6pt,color=myGreen, densely dotted,] table[x=x ,y=u_pred]{data/adaptative/u_atan.csv};
%\addlegendentry{$u_{h\text{-adap.}}$};
%
%
%%%%%%%%%%%%r-adaptive
%\addplot[only marks, color = red, mark = *, mark options={solid},forget plot] 
%coordinates{(2.5,9.768009205947777995e-02)(5,1.471106131310532472e+00)(7.5, 2.844542268351094805e+00)};
%
%%%r-adaptativity
%\addplot[line width=0.6pt,color=red, densely dotted,mark=o, mark options={solid}] table[x=x ,y=u_pred]{data/piecewise_1D/atan/r_adaptivity_pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_17_epoch_10000_partition.csv};
%\addlegendentry{$u_{r\text{-adap.}}$ };
%
%%%piecewise
%\addplot[line width=0.5pt,color=blue, dashed, mark=triangle, mark options={solid}] table[x=x ,y=u_pred]{data/piecewise_1D/atan/pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_21_epoch_10000_partition.csv};
%\addlegendentry{$u_{p=1}$ };
%
%
%%mesh
%\addplot[only marks,color=red,mark=|, mark options={solid}] table[x=x ,y=malla]{data/piecewise_1D/atan/r_adaptivity_pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_17_epoch_10000_partition.csv};
%\end{axis}
%\end{tikzpicture}
%};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%%Graph error
%\node at (9.1,1.2){$error_{(\cdot)} :=|u - u_{(\cdot)}|$};
%
%\node [anchor = north east]at (12.5,1){
%\begin{tikzpicture}
%\begin{axis}[scale only axis, xlabel = $x$,  
%xtick pos=left,
%ytick pos=left, 
%ymode = log,
%y label style={at={(-0.1,0.5)}}, 
%height=4.5cm, width=5.5cm, 
%xmin=0, ymin=0, 
%xmax=10, ymax=0.009,
%legend columns = 1,
%legend style= {at={(0.5,0.95)},draw=none,fill=none,nodes={scale=1, transform shape}}, 
%legend cell align={left}
%]
%%
%
%%\addplot[only marks, color = red, mark = *, mark options={solid},forget plot] 
%%coordinates{(2.5,9.768009205947777995e-02)(5,1.471106131310532472e+00)(7.5, 2.844542268351094805e+00)};
%%%piecewise
%\addplot[line width=0.5pt,color=myGreen, densely dotted, ] table[x=x ,y=error]{data/adaptative/u_atan.csv};
%%\addlegendentry{$L_1\text{error}_{p=1}$};
%\node [myGreen, anchor = west](B) at (axis cs:  0.1, 0.003){$error_{h\text{-adap.}}$};
%
%%%r-adaptativity
%\addplot[line width=0.6pt,color=red, densely dotted,mark=o, mark options={solid}] table[x=x ,y=error]{data/piecewise_1D/atan/r_adaptivity_pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_17_epoch_10000_partition.csv};
%%\addlegendentry{$L_1\text{error}_{r\text{-adaptivity}}$ };
%\node [red, anchor = west](R) at (axis cs: 3.5,0.00001 ){$error_{r\text{-adap.}}$};
%
%%%piecewise
%\addplot[line width=0.5pt,color=blue, dashed, mark=triangle, mark options={solid}] table[x=x ,y=error]{data/piecewise_1D/atan/pb_131_nGauss_4_alpha_2.0_beta_5.0_elemts_21_epoch_10000_partition.csv};
%%\addlegendentry{$L_1\text{error}_{p=1}$};
%\node [blue, anchor = west](B) at (axis cs:  5.3, 0.004){$error_{p=1}$};
%\end{axis}
%
%\end{tikzpicture}
%};
%\end{tikzpicture}
%
%\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%