%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Model problem 1 - $H^{1}\setminus H^2$}
\vspace{0.5cm}
\begin{tikzpicture}
%Problem

\draw[very thin,rounded corners=2pt, fill=orange!30!white ] (-1,0.4) rectangle (5.,3);

\node [anchor = west] at (-0.5,1.7){
$
\def\arraystretch{1.1}
\left\{ \! \! \!
\begin{array}{rll}
-\triangle u & \!\!= f &  x \in (0,10) 
\\
u & \!\!= 0 &  x =0 
\\
(\nabla u) \cdot \bf{n}  &\!\! =g &  x=10
\end{array}
\right.
$
};

%\draw[very thin,rounded corners=4pt, fill=gray!30!white ] (-1.8,2.7) rectangle (0.6,3.3);
%\node [anchor = west] at (-1.8,3){Test problem};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%small squares
\draw[very thin,rounded corners=2pt, fill=orange!30!white ] (-1.5,0) rectangle (1.,-0.6);
\node [anchor =  west] at (-1.3,-0.3){
$u_{exact} = x^{0.7} $
};
%%%%%%%
%\draw[very thin,rounded corners=2pt, fill=gray!30!white ] (-1.5,-1) rectangle (2,-1.6);
%\node [anchor = west] at (-1.5,-1.3){
%$\alpha =2.0  \quad \beta=5.0$};

\node [anchor = west] at (-1.5,-2.7){
$\mathcal{T}_{r\text{-adap.}}$};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%Graph
\node [anchor = north east]at (12.5,2.9){
\begin{tikzpicture}
\begin{axis}[scale only axis, xlabel = $x$, ylabel = $u$, 
ytick pos=left,
xtick pos=left,
y label style={at={(-0.1,0.5)}}, 
height=6cm, width=5.5cm, 
xmin=0, ymin=0, 
xmax=10, ymax=5,
legend columns = 1,
legend style= {at={(0.5,0.95)},draw=none,fill=none,nodes={scale=1, transform shape}}, 
legend cell align={left}
]
%

%%exact solution
\addplot [black, line width=0.7pt,domain=0:10] table[x=x ,y=u_exact]{frames/Javi/data/piecewise_1D/0.7/exact.csv};
\addlegendentry{$u_{exact}$ };


%%r-adaptativity
\addplot[line width=0.6pt,color=red, densely dotted,mark=o, mark options={solid}] table[x=x ,y=u_pred]{frames/Javi/data/piecewise_1D/0.7/r_adaptivity_pb_121_nGauss_4_alpha_0.7_beta_5.0_elemts_21_epoch_5000_partition.csv};
\addlegendentry{$u_{p}$ };

%%piecewise
%\addplot[line width=0.5pt,color=blue, dashed, mark=triangle, mark options={solid}] table[x=x ,y=u_pred]{frames/Javidata/piecewise_1D/0.7/pb_121_nGauss_4_alpha_0.7_beta_5.0_elemts_21_epoch_5000_partition.csv};
%\addlegendentry{$u_{p=1}$ };

\end{axis}
\end{tikzpicture}
};

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%%%%%Mesh
\node [anchor = west]at (-1.5,-3.5){
\begin{tikzpicture}
\begin{axis}[scale only axis,% xlabel = $x$, %ylabel = $u$, 
%ytick pos=left,
%xtick pos=left,
%y label style={at={(-0.1,0.5)}}, 
height=1cm, width=7cm,
axis y line=none, 
xmin=0, xmax = 10, 
legend cell align={left},
axis x line = center,
    axis y line = center,
    axis line style={-},
%    every axis/.style={pin distance=1ex},
%    trim axis left
]

%%malla
\addplot[only marks,color=red, ,mark=|, mark options={solid}] table[x=x ,y=malla]{frames/Javi/data/piecewise_1D/0.7/r_adaptivity_pb_121_nGauss_4_alpha_0.7_beta_5.0_elemts_21_epoch_5000_partition.csv};

\end{axis}
\end{tikzpicture}
};



\end{tikzpicture}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


